Beginner Tutorial - Set up & Running One Algorithm
===================================================

TODO: add an explanation of this tutorial

Step 0: Clone the SPRAS repository, set up the environment, and run Docker
---------------------------------------------------------------------------

1. Start Docker

Launch Docker Desktop and wait until it says "Docker is running".

2. Clone the SPRAS repository

Visit the `SPRAS github repository <https://github.com/Reed-CompBio/spras>`__ and clone it locally

3. 	Set up the SPRAS environment

From the root directory of the SPRAS repository, create and activate the Conda environment:

.. code:: bash

    conda env create -f environment.yml
    conda activate spras
    python -m pip install .

4. Test the installation

Run the following command to confirm that SPRAS has been set up successfully from the command line:

.. code:: bash

   python -c "import spras; print('SPRAS import successful')"

Step #: Explanation of the Folders
-----------------------------------

.. add more details on this and explanations

.. code-block:: text

   spras/
   ├── .snakemake/
   │   └── log/
   │       └── ... snakemake log files ...
   ├── config/
   │   └── ... other configs ...
   ├── inputs/
   │   └── ... input files ...
   ├── outputs/
   │   └── ... output files ...


After cloning SPRAS, you will see three (four?) main folders that organize everything needed to run and analyze workflows:

1. config/

Holds configuration files (YAML) that define which algorithms to run, what datasets to use, and which analyses to perform.

2. input/

Contains the input data files, such as interactome edge files and input nodes. This is where youcan place your own datasets when running custom experiments.

TODO: show the input types?

3. output/

Stores all results generated by SPRAS. Subfolders are created automatically for each run, and their structure can be controlled through the configuration file.

4. TODO: should I also include .snakemake? for the logs?


TODO: add that the config, input, and output folders can be set to new locations in the configuration file. As default, they are config/, input/ and ouput/
TODO: explain there are other files and folders, but for a user and for this tutorial they are not important to fully know about


Step #: Explanation of Configuration File
-------------------------------------------

A configuration file controls how SPRAS runs.  It defines which algorithms to run, the parameters to use, the datasets and gold standards to include, the analyses to perform after reconstruction, and the container settings for execution. Think of it as the control center for the workflow.

.. This will run SPRAS using the example config file (config/config.yaml) and input files. 
.. SPRAS will automatically pull any missing Docker images as long as Docker is running.
.. Results will be written to the output directory.

SPRAS uses Snakemake, a workflow manager, which reads the configuration file to build and execute a SPRAS workflow. Snakemake marks a task as complete once the expected output files are present in the output directory. As a result, rerunning the same configuration may do nothing if those files already exist. To continue running SPRAS, you can either remove the output directory (or its contents) or update the configuration file so that Snakemake generates new results.

Download the configuration file here: :download:`Beginner Config File <../_static/config/beginner.yaml>`

Save the file into the config/ folder of your SPRAS installation (with spras/ as your project root).
For this config file, your folder and file structure will now look like:

.. code-block:: text

   spras/
   ├── .snakemake/
   │   └── log/
   │       └── ... snakemake log files ...
   ├── config/
   │   └── basic.yaml
   ├── inputs/
   │   ├── phosphosite-irefindex13.0-uniprot.txt
   │   └── tps-egfr-prizes.txt
   ├── outputs/
   │   └── basic/
   │       └── ... output files ...


.. # Instead of explaining the whole configuration file, 1st make the basic config then once that is done, explain the parts that are in that that are important
.. - 1 algorithm with 1 parameter setting
.. - the egfr dataset
.. - one analysis
.. - Reconstruction Settings area
.. # explain the rest that is used in medium. Anything unused like the global workflow control (explain that other containerization can be used etc) and any post analysis not used can be added to the hard tutorial (which is now more like the other things that can be done tutorial but won't be shown here)


Here’s an overview of the major sections looking at config/basic.yaml:

1. Algorithms

.. add the algos portion, explain what is happening for the one algorithm 

- Each algorithm has an include flag (true/false) to turn it on or off.
- Parameters are specified under params. If multiple parameter values are listed, SPRAS will run the algorithm once for every combination (a parameter sweep).
- This section is where you decide which methods you want to try and how they’re tuned. For this part of the tutorial we will be using XXX

2. Datasets

.. add the dataset  portion, explain what is happening for the one dataset 

Defines the input files SPRAS will use to run pathway reconstruction

A dataset is comprised of: 

- a label: defines the name of the dataset
- node_files: the input nodes to use that are the molecules of interest (sources, targets, prizes, actives, dummy nodes) (add which one is ours)
- edge_files: the interactome (add which one is ours)
- data_dir: the path to where the input dataset files live
- other_files: a placefolder for potential need for future delevvelopment

5. Reconstruction Settings

- Defines the filepath where reconstructed networks are saved (output directory by default)
- Basic housekeeping for how SPRAS organizes and stores results.

6. Analysis

.. add the analysis portion, explain what is happening for the one dataset 

- Each analysis has an include: true/false toggle

Controls which types of post-analysis are run, for this part of the tutorial:

- Summary statistics: calculates metrics per dataset for each algorithm
- Cytoscape export: generates .cys session files for each output subnetwork for easy visualization


Step #: Running SPRAS on a provided example dataset 
---------------------------------------------------

- egfr 
- one algorithm
- three different preset combos
    - run one at a time, then describe what is happening in the output files and the caching
- provide a config template to use? YES but mostly prefilled out. leave one or two combos commented out that a user can rerun or provide examples in the tutorial itself that a user can copy and paste
    - provide different ways parameters can be updated? list vs single int or str for now (show the other ways in the hard/in future stuff)


Step #: Understanding the Outputs / Visulizing the Outputs
-----------------------------------------------------------

